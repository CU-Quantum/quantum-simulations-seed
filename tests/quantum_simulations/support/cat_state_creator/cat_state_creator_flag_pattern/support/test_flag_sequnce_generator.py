from numpy.ma import allequal

from quantum_simulations.support.cat_state_creator.cat_state_creator_flag_pattern.support.flag_sequnce_generator import \
    FlagSequenceGenerator


class TestFlagSequenceGenerator:
    def test_base_case_0(self):
        sequence = FlagSequenceGenerator(num_flags=0).get_flag_sequence()
        assert allequal(sequence, [[]])

    def test_base_case_1(self):
        sequence = FlagSequenceGenerator(num_flags=1).get_flag_sequence()
        assert allequal(sequence, [[0], [1]])

    def test_base_case_2(self):
        sequence = FlagSequenceGenerator(num_flags=2).get_flag_sequence()
        assert allequal(sequence, [[1, 0], [1, 1], [0, 1]])

    def test_base_case_3(self):
        sequence = FlagSequenceGenerator(num_flags=3).get_flag_sequence()
        assert allequal(sequence, [[1, 0, 0], [1, 1, 0], [1, 1, 1], [0, 1, 1], [0, 0, 1]])

    def test_case_4(self):
        sequence = FlagSequenceGenerator(num_flags=4).get_flag_sequence()
        assert allequal(sequence, [
            [1, 0, 0, 0],
            [1, 1, 0, 0],
            [1, 1, 1, 0],
            [0, 1, 1, 0],

            [0, 1, 1, 1],
            [1, 1, 1, 1],
            [1, 0, 1, 1],
            [1, 0, 0, 1],

            [1, 1, 0, 1],
            [0, 1, 0, 1],
            [0, 0, 0, 1],
        ])

    def test_case_5(self):
        sequence = FlagSequenceGenerator(num_flags=5).get_flag_sequence()
        assert allequal(sequence, [
            [1, 0, 0, 0, 0],
            [1, 1, 0, 0, 0],
            [1, 1, 1, 0, 0],
            [0, 1, 1, 0, 0],
            [0, 1, 1, 1, 0],
            [1, 1, 1, 1, 0],
            [1, 0, 1, 1, 0],
            [1, 0, 0, 1, 0],
            [1, 1, 0, 1, 0],
            [0, 1, 0, 1, 0],

            [0, 1, 0, 1, 1],
            [1, 1, 0, 1, 1],
            [1, 1, 0, 0, 1],
            [1, 1, 1, 0, 1],
            [1, 1, 1, 1, 1],
            [0, 1, 1, 1, 1],
            [0, 0, 1, 1, 1],
            [1, 0, 1, 1, 1],
            [1, 0, 0, 1, 1],
            [1, 0, 0, 0, 1],

            [1, 0, 1, 0, 1],
            [0, 0, 1, 0, 1],
            [0, 1, 1, 0, 1],
            [0, 1, 0, 0, 1],
            [0, 0, 0, 0, 1],
        ])

    def test_case_6(self):
        sequence = FlagSequenceGenerator(num_flags=6).get_flag_sequence()
        assert allequal(sequence, [
            [1, 0, 0, 0, 0, 0],
            [1, 1, 0, 0, 0, 0],
            [1, 1, 1, 0, 0, 0],
            [0, 1, 1, 0, 0, 0],
            [0, 1, 1, 1, 0, 0],
            [1, 1, 1, 1, 0, 0],
            [1, 0, 1, 1, 0, 0],
            [1, 0, 0, 1, 0, 0],
            [1, 1, 0, 1, 0, 0],
            [0, 1, 0, 1, 0, 0],
            [0, 1, 0, 1, 1, 0],
            [1, 1, 0, 1, 1, 0],
            [1, 1, 0, 0, 1, 0],
            [1, 1, 1, 0, 1, 0],
            [1, 1, 1, 1, 1, 0],
            [0, 1, 1, 1, 1, 0],
            [0, 0, 1, 1, 1, 0],
            [1, 0, 1, 1, 1, 0],
            [1, 0, 0, 1, 1, 0],
            [1, 0, 0, 0, 1, 0],
            [1, 0, 1, 0, 1, 0],
            [0, 0, 1, 0, 1, 0],
            [0, 1, 1, 0, 1, 0],
            [0, 1, 0, 0, 1, 0],

            [0, 1, 0, 0, 1, 1],
            [0, 1, 1, 0, 1, 1],
            [0, 1, 1, 0, 0, 1],
            [1, 1, 1, 0, 0, 1],
            [1, 1, 0, 0, 0, 1],
            [1, 1, 0, 1, 0, 1],
            [1, 1, 1, 1, 0, 1],
            [0, 1, 1, 1, 0, 1],
            [0, 1, 1, 1, 1, 1],
            [1, 1, 1, 1, 1, 1],
            [1, 1, 1, 0, 1, 1],
            [1, 1, 0, 0, 1, 1],
            [1, 1, 0, 1, 1, 1],
            [0, 1, 0, 1, 1, 1],
            [0, 0, 0, 1, 1, 1],
            [1, 0, 0, 1, 1, 1],
            [1, 0, 0, 1, 0, 1],
            [1, 0, 1, 1, 0, 1],
            [1, 0, 1, 1, 1, 1],
            [0, 0, 1, 1, 1, 1],
            [0, 0, 1, 0, 1, 1],
            [1, 0, 1, 0, 1, 1],
            [1, 0, 0, 0, 1, 1],
            [1, 0, 0, 0, 0, 1],

            [1, 0, 1, 0, 0, 1],
            [0, 0, 1, 0, 0, 1],
            [0, 0, 1, 1, 0, 1],
            [0, 0, 0, 1, 0, 1],
            [0, 1, 0, 1, 0, 1],
            [0, 1, 0, 0, 0, 1],
            [0, 0, 0, 0, 0, 1],
        ])

    def test_case_7(self):
        sequence = FlagSequenceGenerator(num_flags=7).get_flag_sequence()
        assert allequal(sequence, [
            [1, 0, 0, 0, 0, 0, 0],
            [1, 1, 0, 0, 0, 0, 0],
            [1, 1, 1, 0, 0, 0, 0],
            [0, 1, 1, 0, 0, 0, 0],
            [0, 1, 1, 1, 0, 0, 0],
            [1, 1, 1, 1, 0, 0, 0],
            [1, 0, 1, 1, 0, 0, 0],
            [1, 0, 0, 1, 0, 0, 0],
            [1, 1, 0, 1, 0, 0, 0],
            [0, 1, 0, 1, 0, 0, 0],
            [0, 1, 0, 1, 1, 0, 0],
            [1, 1, 0, 1, 1, 0, 0],
            [1, 1, 0, 0, 1, 0, 0],
            [1, 1, 1, 0, 1, 0, 0],
            [1, 1, 1, 1, 1, 0, 0],
            [0, 1, 1, 1, 1, 0, 0],
            [0, 0, 1, 1, 1, 0, 0],
            [1, 0, 1, 1, 1, 0, 0],
            [1, 0, 0, 1, 1, 0, 0],
            [1, 0, 0, 0, 1, 0, 0],
            [1, 0, 1, 0, 1, 0, 0],
            [0, 0, 1, 0, 1, 0, 0],
            [0, 1, 1, 0, 1, 0, 0],
            [0, 1, 0, 0, 1, 0, 0],
            [0, 1, 0, 0, 1, 1, 0],
            [0, 1, 1, 0, 1, 1, 0],
            [0, 1, 1, 0, 0, 1, 0],
            [1, 1, 1, 0, 0, 1, 0],
            [1, 1, 0, 0, 0, 1, 0],
            [1, 1, 0, 1, 0, 1, 0],
            [1, 1, 1, 1, 0, 1, 0],
            [0, 1, 1, 1, 0, 1, 0],
            [0, 1, 1, 1, 1, 1, 0],
            [1, 1, 1, 1, 1, 1, 0],
            [1, 1, 1, 0, 1, 1, 0],
            [1, 1, 0, 0, 1, 1, 0],
            [1, 1, 0, 1, 1, 1, 0],
            [0, 1, 0, 1, 1, 1, 0],
            [0, 0, 0, 1, 1, 1, 0],
            [1, 0, 0, 1, 1, 1, 0],
            [1, 0, 0, 1, 0, 1, 0],
            [1, 0, 1, 1, 0, 1, 0],
            [1, 0, 1, 1, 1, 1, 0],
            [0, 0, 1, 1, 1, 1, 0],
            [0, 0, 1, 0, 1, 1, 0],
            [1, 0, 1, 0, 1, 1, 0],
            [1, 0, 0, 0, 1, 1, 0],
            [1, 0, 0, 0, 0, 1, 0],
            [1, 0, 1, 0, 0, 1, 0],
            [0, 0, 1, 0, 0, 1, 0],
            [0, 0, 1, 1, 0, 1, 0],
            [0, 0, 0, 1, 0, 1, 0],
            [0, 1, 0, 1, 0, 1, 0],
            [0, 1, 0, 0, 0, 1, 0],

            [0, 1, 0, 0, 0, 1, 1],
            [0, 1, 0, 1, 0, 1, 1],
            [0, 1, 0, 1, 0, 0, 1],
            [0, 1, 1, 1, 0, 0, 1],
            [0, 1, 1, 0, 0, 0, 1],
            [1, 1, 1, 0, 0, 0, 1],
            [1, 1, 0, 0, 0, 0, 1],
            [1, 1, 0, 0, 1, 0, 1],
            [1, 1, 1, 0, 1, 0, 1],
            [0, 1, 1, 0, 1, 0, 1],
            [0, 1, 1, 1, 1, 0, 1],
            [1, 1, 1, 1, 1, 0, 1],
            [1, 1, 1, 1, 0, 0, 1],
            [1, 1, 0, 1, 0, 0, 1],
            [1, 1, 0, 1, 1, 0, 1],
            [0, 1, 0, 1, 1, 0, 1],
            [0, 1, 0, 1, 1, 1, 1],
            [1, 1, 0, 1, 1, 1, 1],
            [1, 1, 0, 0, 1, 1, 1],
            [1, 1, 1, 0, 1, 1, 1],
            [1, 1, 1, 1, 1, 1, 1],
            [0, 1, 1, 1, 1, 1, 1],
            [0, 1, 1, 1, 0, 1, 1],
            [1, 1, 1, 1, 0, 1, 1],
            [1, 1, 0, 1, 0, 1, 1],
            [1, 1, 0, 0, 0, 1, 1],
            [1, 1, 1, 0, 0, 1, 1],
            [0, 1, 1, 0, 0, 1, 1],
            [0, 1, 1, 0, 1, 1, 1],
            [0, 1, 0, 0, 1, 1, 1],
            [0, 0, 0, 0, 1, 1, 1],
            [0, 0, 1, 0, 1, 1, 1],
            [0, 0, 1, 0, 1, 0, 1],
            [1, 0, 1, 0, 1, 0, 1],
            [1, 0, 0, 0, 1, 0, 1],
            [1, 0, 0, 1, 1, 0, 1],
            [1, 0, 1, 1, 1, 0, 1],
            [0, 0, 1, 1, 1, 0, 1],
            [0, 0, 1, 1, 1, 1, 1],
            [1, 0, 1, 1, 1, 1, 1],
            [1, 0, 1, 0, 1, 1, 1],
            [1, 0, 0, 0, 1, 1, 1],
            [1, 0, 0, 1, 1, 1, 1],
            [0, 0, 0, 1, 1, 1, 1],
            [0, 0, 0, 1, 0, 1, 1],
            [1, 0, 0, 1, 0, 1, 1],
            [1, 0, 0, 1, 0, 0, 1],
            [1, 0, 1, 1, 0, 0, 1],
            [1, 0, 1, 1, 0, 1, 1],
            [0, 0, 1, 1, 0, 1, 1],
            [0, 0, 1, 0, 0, 1, 1],
            [1, 0, 1, 0, 0, 1, 1],
            [1, 0, 0, 0, 0, 1, 1],
            [1, 0, 0, 0, 0, 0, 1],

            [1, 0, 1, 0, 0, 0, 1],
            [0, 0, 1, 0, 0, 0, 1],
            [0, 0, 1, 1, 0, 0, 1],
            [0, 0, 0, 1, 0, 0, 1],
            [0, 0, 0, 1, 1, 0, 1],
            [0, 0, 0, 0, 1, 0, 1],
            [0, 1, 0, 0, 1, 0, 1],
            [0, 1, 0, 0, 0, 0, 1],
            [0, 0, 0, 0, 0, 0, 1],
        ])
